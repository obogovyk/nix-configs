-A INPUT -i lo -j ACCEPT
-A INPUT -i eth0 -j BLACKLIST
-A INPUT -i eth0 -p tcp -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
-A INPUT -i eth0 -p tcp -m conntrack --ctstate NEW -m tcp ! --tcp-flags FIN,SYN,RST,ACK SYN -j DROP
-A INPUT -i eth0 -p tcp --syn -m limit --limit 128/s --limit-burst 256 -j ACCEPT
-A INPUT -i eth0 -p udp -m limit --limit 50/s -j ACCEPT
-A INPUT -i eth0 -p icmp -m limit --limit 10/sec -j LOG --log-prefix "Ping Flood: "
-A INPUT -i eth0 -p icmp -m limit --limit 10/sec --limit-burst 20 -j ACCEPT
-A INPUT -i eth0 -p tcp -m conntrack --ctstate NEW -m multiport --dports 80,443 -j LOG --log-prefix "WebAcess: " --log-level 4
-A INPUT -i eth0 -p tcp -m conntrack --ctstate NEW -m multiport --dports 80,443 -j ACCEPT
-A INPUT -i eth0 -p tcp --dport 80 -m connlimit --connlimit-above 32 -j DROP
-A INPUT -i eth0 -p tcp --dport 443 -m connlimit --connlimit-above 32 -j DROP
-A INPUT -i eth0 -p tcp --dport 22 -m connlimit --connlimit-above 2 -j DROP # --connlimit-mask 32/24
-A INPUT -i eth0 -j REJECT --reject-with reject-with tcp-reset
---
# BLACKLIST EXAMPLE
-A BLACKLIST -s 218.xx.xx.xxx/32 -i eth0 -p tcp -m tcp --dport 22 -j REJECT --reject-with icmp-host-prohibited
-A BLACKLIST -j RETURN
